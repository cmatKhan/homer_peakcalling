/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Nextflow config file for running minimal tests
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Defines input files and everything required to run a fast and simple pipeline test.

    Use as follows:
        nextflow run cmatkhan/homer_peakcalling_from_bam -profile test,<docker/singularity> --outdir <OUTDIR>

----------------------------------------------------------------------------------------
*/

process {

    withName: 'SAMTOOLS_VIEW' {
        ext.prefix = { "${meta.id}_filtered" } 
        ext.args = [
            "-F 1024",
            "-q 1"
        ].join(' ')
    }

    withName: '.*:HOMER_MAKETAGDIRECTORY_CNTRL' {
        ext.prefix = "realControl"
    }

    withName: '.*:HOMER_.*MAKETAGDIRECTORY.*' {
        ext.args = [
        '-checkGC',
        '-fragLength 1'         // Treat as single base (5' end)
    ].join(' ')
        
    }
// '-size 100',        // Peak size (ChExMix uses variable, 100bp is reasonable start)
// default is auto and it is inferred from MAKETAGDIRECTORY
withName: '.*:HOMER_*FINDPEAKS.*' {
    ext.args = [
        '-L 2',              // Local fold enrichment (2-fold)
        '-LP 0.001',         // Local poisson p-value (relaxed from 0.0001)
        '-F 4',              // Control fold enrichment (4-fold)
        '-P 0.001',          // Control poisson p-value (relaxed from 0.0001)
        '-fdr 0.05',         // Overall false discovery rate
        '-localSize 1000',   // Local background window
        '-fragLength 150',   // Expected fragment length
        '-C 0'               // Disable clonal filtering for MNase experiments
    ].join(' ')

}

}

